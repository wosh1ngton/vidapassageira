<div class="destinos-container">
    <p-toast />
    <p-confirmdialog />

    <!-- Header Section -->
    <div class="page-header">
        <div class="header-content">
            <div class="header-left">
                <div class="icon-wrapper">
                    <i class="pi pi-map-marker"></i>
                </div>
                <div class="title-group">
                    <h1 class="page-title">Meus Destinos</h1>
                    <p class="page-subtitle">Gerencie seus destinos favoritos</p>
                </div>
            </div>
            <button pButton
                    label="Novo Destino"
                    icon="pi pi-plus"
                    class="add-button"
                    (click)="abrirDestinoDialog()"></button>
        </div>
    </div>

    <app-form-destino
        [destinoParaEditar]="destinoSelecionado"
        (destinoSalvo)="atualizaListagemDestinos()"
        [(modalStatus)]="modalDialog">
    </app-form-destino>

    <!-- Content Section -->
    <div class="content-wrapper">
        <!-- Barra de Busca -->
        <div class="search-bar">
            <span class="p-input-icon-left search-input-wrapper">
                <i class="pi pi-search"></i>
                <input pInputText
                       type="text"
                       [(ngModel)]="termoBusca"
                       (ngModelChange)="onBuscaChange($event)"
                       placeholder="Buscar destino por nome ou localização..."
                       class="search-input" />
            </span>
            <button *ngIf="termoBusca"
                    pButton
                    icon="pi pi-times"
                    class="p-button-text p-button-sm clear-search-button"
                    pTooltip="Limpar busca"
                    (click)="limparBusca()"></button>
        </div>

        <!-- Skeleton Loading -->
        <div class="destinos-grid" *ngIf="loading">
            <div class="destino-card-skeleton" *ngFor="let item of [1,2,3,4,5,6]">
                <div class="skeleton-image"></div>
                <div class="skeleton-content">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-location"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text short"></div>
                </div>
                <div class="skeleton-actions">
                    <div class="skeleton skeleton-button"></div>
                    <div class="skeleton skeleton-button"></div>
                    <div class="skeleton skeleton-button wide"></div>
                </div>
            </div>
        </div>

        <!-- Empty State - Busca sem resultados -->
        <div *ngIf="!loading && destinos.length === 0 && termoBusca" class="empty-state">
            <div class="empty-illustration">
                <i class="pi pi-search"></i>
            </div>
            <h3 class="empty-title">Nenhum destino encontrado</h3>
            <p class="empty-message">
                Não encontramos destinos para "{{ termoBusca }}".<br>
                Tente buscar com outro termo ou cadastre um novo destino.
            </p>
            <button pButton
                    label="Limpar Busca"
                    icon="pi pi-times"
                    class="empty-button"
                    (click)="limparBusca()"></button>
        </div>

        <!-- Empty State - Sem destinos -->
        <div *ngIf="!loading && destinos.length === 0 && !termoBusca" class="empty-state">
            <div class="empty-illustration">
                <i class="pi pi-map-marker"></i>
            </div>
            <h3 class="empty-title">Nenhum destino cadastrado</h3>
            <p class="empty-message">
                Comece sua jornada adicionando seus destinos favoritos.<br>
                Explore o mundo e planeje suas próximas aventuras!
            </p>
            <button pButton
                    label="Adicionar Primeiro Destino"
                    icon="pi pi-plus"
                    class="empty-button"
                    (click)="abrirDestinoDialog()"></button>
        </div>

        <!-- Lista de Destinos -->
        <div class="destinos-grid" *ngIf="!loading && destinos.length > 0">
            <div class="destino-card" *ngFor="let destino of destinos">
                <div class="card-image-wrapper">
                    <img *ngIf="destino.imagemBase64"
                         [src]="destino.imagemBase64"
                         [alt]="destino.nome"
                         class="card-image" />
                    <div *ngIf="!destino.imagemBase64" class="card-image-placeholder">
                        <i class="pi pi-image"></i>
                    </div>
                    <div class="card-overlay">
                        <button pButton
                                icon="pi pi-eye"
                                class="p-button-rounded p-button-text overlay-button"
                                pTooltip="Ver detalhes"></button>
                    </div>
                </div>

                <div class="card-content">
                    <h3 class="card-title">{{ destino.nome }}</h3>
                    <div class="card-location">
                        <i class="pi pi-map-marker"></i>
                        <span>{{ destino.localizacao }}</span>
                    </div>
                    <p class="card-description">{{ destino.descricao }}</p>
                </div>

                <div class="card-actions">
                    <button pButton
                            icon="pi pi-pencil"
                            class="p-button-sm p-button-text"
                            pTooltip="Editar"
                            (click)="editarDestino(destino)"></button>
                    <button pButton
                            icon="pi pi-trash"
                            class="p-button-sm p-button-text p-button-danger"
                            pTooltip="Excluir"
                            (click)="confirmarDelecao(destino.id)"></button>
                    <button pButton
                            label="Agendar Viagem"
                            icon="pi pi-calendar-plus"
                            class="p-button-sm schedule-button"
                            (click)="criarViagem(destino)"></button>
                </div>
            </div>
        </div>
    </div>
</div>
